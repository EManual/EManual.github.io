AJAX全称为"Asynchronous JavaScript and XML"(异步JavaScript和XML)，是指一种创建交互式网页应用的
网页开发技术。它容许网页的部分刷新，比起传统的整个页面刷新，传输的数据量大大减少，这样就显著提高了
用户浏览web页面的速度。
1)  获取ajax核心对象XMLHttpRequest的标准JavaScript函数 : 
[code=java]
	function createXhr(){
		// 判断是IE浏览器还是其他浏览器，然后返回对象
		if(window.ActiveXObject){
			return new ActiveXObject("Microsoft.XMLHTTP");
		}else if(window.XMLHttpRequest){
			return new XMLHttpRequest();
		}else{ throw new Error("Does not ajax programming");}
	}
[/code]	
注 : 下面的笔记中，都用 createXhr()这个函数获取XMLHttpRequest对象
2)  实例 : 在网页中验证电子邮箱输入的格式
(1) 网页文件
[code=java]
<title>Validate Email Format</title>
<!-- createXhr()以及其他工具函数都在utils.js中 -->
<script type="text/javascript" src="js/utils.js"></script>

<script type="text/javascript">			
	//以下是标准的步骤，要牢记
	var xhr = null;
	function validateEmail(){
		xhr = createXhr();// 获取XMLHttpRequest对象
// 要提交到服务器的请求，escape函数用于除去字符串两端空格，$函数根据id获得对象(此方法在util.js中)  vm是servlet的访问地址
		var url = "vm?mail=" + escape($("mail").value);
		/* 指定发送的方式、接受请求的页面(或servlet)、是否采用异步回调
		 * 参数也可以是("GET", url, true)
		 * true是默认的，故可省略不写，表示采用异步回调
		 */
		xhr.open("GET", url);
		// 指定异步回调函数
		xhr.onreadystatechange = displayStatus;
		
		// 若采用POST方式提交请求，这里就必须发送请求体，这里是GET方式，故为NULL
			   //请求体的设置xhr.setRequestHeader(“Content-Type”,”application/x-www-form-urlencoded”);
		xhr.send(null);
	}
	//异步回调函数的实现
	function displayStatus(){
// readyState是服务端状态， 0代表无状态，1代表建立连接，2准备发送数据，3正在发送数据 ，等于4表明对请求响应完毕，该返回客户端的数据都返回了
		if(xhr.readyState == 4){
			// status是客户端状态，等于200表明数据已经存在于缓存，可以直接拿来使用了
400 url出错，500内部出错
			if(xhr.status == 200){
				var status = $("mailFormatStatus");
				// 获得服务器返回的文本数据
				var mailStatus = xhr.responseText;
				if(mailStatus == "true"){
					status.innerHTML = "valid email format";
				}else{ status.innerHTML = "invalid email format";	}
			}else{// 获得客户端状态值以及对应的描述性文本
				errorHandler(xhr.status, xhr.statusText);}
		}else{ status.innerHTML = "please wait..."; }}
</script>
</head>
<body>
	<h2>Please enter an email address to validate</h2>
	<input type="text" id="mail" onblur="validateEmail()"/><br/>
	<div id="mailFormatStatus"></div>
</body>
</html>
[/code]		
(2) Servlet文件ValidateEmailFormatServlet.java片段
[code=java]
protected void doGet(HttpServletRequest request, HttpServletResponse response) 
	throws ServletException, IOException {
	// 注意这里不是"text/html" 因为我们只需要返回纯文本字符串即可 故用"text/plain"
	response.setContentType("text/plain;charset=gbk");
	String mail = request.getParameter("mail");
	String status = "false";
	if(mail != null){
		Pattern p = Pattern.compile("\\S+@\\S+");
		Matcher m = p.matcher(mail);
		if(m.matches()) status = "true";
	}
	PrintWriter out = response.getWriter();
	out.print(status);
	out.flush();
	//这里关闭与否 应该无关痛痒
	out.close();
}
[/code]
(3) web.xml片段
[code=java]
<servlet>
	<description>
	</description>
	<display-name>
	ValidateEmailFormatServlet</display-name>
	<servlet-name>ValidateEmailFormatServlet</servlet-name>
	<servlet-class>
	com.kettas.ajax.xhr.day1.ValidateEmailFormatServlet</servlet-class>
</servlet>
<servlet-mapping>
	<servlet-name>ValidateEmailFormatServlet</servlet-name>
	<url-pattern>/vm</url-pattern>
</servlet-mapping>
[/code]		
3)  向服务器请求获得xml文件(对象)
本例中，得到从服务器返回的xml对象，然后将数据填充到表格
[code=java]
<title>Online super store</title>
<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript">
	var xhr = null;
	function initStore(){
		xhr = createXhr();
		xhr.open("GET", "xmlListProduct.jsp");
		xhr.onreadystatechange = display;
		xhr.send(null);
	}
	
	function display(){
		if(xhr.readyState == 4){
			if(xhr.status == 200){
				fillStoreTable(xhr.responseXML);
			}else{
				errorHandler(xhr.status, xhr.statusText);
			}}}
	function fillStoreTable(productsRoot){
		// 将xml数据，填充表格，具体过程略
		...
	}
</script>
</head>
<body onload="initStore();">
<table id="storeTable">
	<tbody id="storeBody">
	</tbody>
</table>
</html>
[/code]	
xmlListProduct.jsp文件内容如下：
[code=java] 
<!-- 注意，客户端需要的是xml文件，故这里是"text/xml" -->
<%@page language="java" contentType="text/xml; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<jsp:useBean id="store" class="com.kettas.ajax.xhr.day1.SuperStore" scope="application"/>
<products>
	<c:forEach var="product" items="${store.products}">
		<product>
			<id>${product.id }</id>
			<name>${product.name }</name>
			<price>${product.price}</price>
		</product>
	</c:forEach>
</products>
[/code]